% Template for a CDF graph
%
% Author: Zengwen Yuan
% Version: 1.0  2017-03-08 init version
% Note: to use package fontspec,
% use XeLaTeX to compile

\documentclass{standalone}
\usepackage{siunitx}
% \usepackage{tikz}
\usepackage{pgfplots}
\usepackage{pgfplotstable}
%\usepackage{verbatim}
\usepackage{tikz}
\usepackage{helvet,etoolbox}
%\usepackage{sansmath}
\usepackage[active,tightpage]{preview}
\PreviewEnvironment{tikzpicture}
\setlength\PreviewBorder{1pt}
\usetikzlibrary{patterns}
\usetikzlibrary{pgfplots.statistics}

\pgfplotsset{compat=newest}

%\usepackage{fontspec}
%\setmainfont[
%BoldFont={Arial Bold},
%ItalicFont={Arial Italic},
%BoldItalicFont={Arial Bold Italic}
%]{Arial}

%\AtBeginEnvironment{tikzpicture}{\sansmath}
%\AtEndEnvironment{tikzpicture}{\unsansmath}

% # user-study-sync-overhead-context-tx-v2.txt
%\pgfplotstableread{
%0   0
%1000   0.1
%5000   0.8
%10000   0.95
%20000   1
%}{\fakedata}

\makeatletter
\pgfplotsset{
my filter/.style args={every#1between#2and#3}{%
/pgfplots/x filter/.append code={%
\ifnum\coordindex<#2%
  % Nothing
\else% Did we pass #3?
  \ifnum\coordindex>#3%
    %Nothing
  \else% Ok filter is on, don't disturb \pgfmathresult for convenience
    \pgfmathsetmacro\temp{int(mod(\coordindex,#1))}%
    \ifnum0=\temp\relax% Are we on the nth point?
      % Yes do nothing let it pass
    \else% discard it
      \let\pgfmathresult\pgfutil@empty
    \fi%
  \fi%
\fi%
}}}
\makeatother



\pgfplotsset{
    compat=newest,
    legend image code/.code={
        \draw[mark repeat=2,mark phase=2]
        plot coordinates {
            (0cm,0cm)
            (0.3cm,0cm)        %% default is (0.3cm,0cm)
            (0.6cm,0cm)         %% default is (0.6cm,0cm)
        };%
    }
}

\makeatletter
\pgfplotsset{
	boxplot prepared from table/.code={
		\def\tikz@plot@handler{\pgfplotsplothandlerboxplotprepared}%
		\pgfplotsset{
			/pgfplots/boxplot prepared from table/.cd,
			#1,
		}
	},
	/pgfplots/boxplot prepared from table/.cd,
	table/.code={\pgfplotstablecopy{#1}\to\boxplot@datatable},
	row/.initial=0,
	make style readable from table/.style={
		#1/.code={
			\pgfplotstablegetelem{\pgfkeysvalueof{/pgfplots/boxplot prepared from table/row}}{##1}\of\boxplot@datatable
			\pgfplotsset{boxplot/#1/.expand once={\pgfplotsretval}}
		}
	},
	make style readable from table=lower whisker,
	make style readable from table=upper whisker,
	make style readable from table=lower quartile,
	make style readable from table=upper quartile,
	make style readable from table=median,
	make style readable from table=lower notch,
	make style readable from table=upper notch,
}
\makeatother

\pgfplotstableread{
	lw lq med  uq uw
-116.05714499999999 -114.59557291666667 -113.41435000000001 -111.0894692982456 -107.34785047619047
-112.67721515151516 -110.72180769230769 -106.64523529411765 -101.81256710526316 -91.52548333333331
0 0 0 0 0
-105.93901666666667 -104.09778333333333 -100.57012499999999 -96.68841666666665 -90.56575272727272
-102.49930555555554 -100.15314880952383 -97.78493333333334 -94.18016193181819 -90.93345897435898
0 0 0 0 0
-89.27329999999999 -85.11166911764705 -80.02044117647058 -76.19478039215686 -73.570945
-80.26655384615384 -76.98705882352941 -74.726 -71.79491666666667 -67.71512857142856
}\datatable

\pgfplotstableread{
	lw lq med  uq uw
	-116.05714499999999 -114.59557291666667 -113.41435000000001 -111.0894692982456 -107.34785047619047
	-105.93901666666667 -104.09778333333333 -100.57012499999999 -96.68841666666665 -90.56575272727272
	-89.27329999999999 -85.11166911764705 -80.02044117647058 -76.19478039215686 -73.570945
}\datatablea

\pgfplotstableread{
	lw lq med  uq uw
	-112.67721515151516 -110.72180769230769 -106.64523529411765 -101.81256710526316 -91.52548333333331
	-102.49930555555554 -100.15314880952383 -97.78493333333334 -94.18016193181819 -90.93345897435898
	-80.26655384615384 -76.98705882352941 -74.726 -71.79491666666667 -67.71512857142856
}\datatableb

\pgfplotstableread{
	x y
1	-125.03225
1	-119.9368667
1	-118.6953333
1	-117.4174286
1	-117.4122778
1	-116.8514167
1	-116.5501154
1	-116.245125
1	-116.1865625
1	-116.1162857
1	-116.1078
1	-107.0927333
1	-106.8872857
1	-106.6838235
1	-106.4216316
1	-106.255875
1	-105.9691765
1	-105.2885714
1	-104.95735
1	-103.126
1	-103.1150556
1	-95.12866667
3.5	-115.6223333
3.5	-110.078
3.5	-109.1015
3.5	-108.8212857
3.5	-108.138
3.5	-107.4266
3.5	-107.2305
3.5	-106.5808235
3.5	-106.33816
3.5	-106.1453
3.5	-105.9596667
3.5	-90.5516
3.5	-90.33427778
3.5	-89.45152632
3.5	-89.16275
3.5	-88.66092308
3.5	-87.30536364
3.5	-86.11931579
3.5	-85.38816667
3.5	-83.1859
3.5	-76.94881818
6	-103.9415
6	-96.80835294
6	-95.299
6	-94.65482353
6	-93.708
6	-92.82635294
6	-91.82536364
6	-91.1485
6	-90.51571429
6	-89.6143125
6	-89.2775
6	-73.56673333
6	-73.29861111
6	-72.9844
6	-72.727125
6	-72.30266667
6	-71.80546154
6	-70.9532
6	-69.66690909
6	-67.91635714
6	-66.62547059
6	-64.89285714
}\outlierdatatablea

\pgfplotstableread{
	x y
2	-115.5136364
2	-114.9738235
2	-113.8977857
2	-113.4816667
2	-113.3865789
2	-113.324125
2	-113.2121429
2	-112.9153684
2	-112.81532
2	-112.70945
2	-112.6831667
2	-90.84675
2	-89.81784211
2	-88.57494118
2	-87.4296
2	-86.00038095
2	-84.94452632
2	-83.29231579
2	-82.86057895
2	-76.42968421
2	-70.57185
4.5	-108.0607222
4.5	-106.4201111
4.5	-105.2720909
4.5	-104.8124762
4.5	-104.6341739
4.5	-104.3567619
4.5	-103.90465
4.5	-103.4517727
4.5	-103.40312
4.5	-102.9042609
4.5	-102.5437778
4.5	-90.91253333
4.5	-90.7533125
4.5	-90.4111875
4.5	-89.92123077
4.5	-89.60933333
4.5	-89.34722222
4.5	-88.6788
4.5	-85.79405882
4.5	-75.91884615
4.5	-73.46945455
7	-90.82175
7	-88.75893333
7	-87.46442857
7	-84.56973333
7	-84.34969231
7	-83.78369231
7	-82.31582353
7	-82.01064286
7	-80.76614286
7	-80.46018182
7	-80.27769231
7	-67.673875
7	-66.10083333
7	-65.8405
7	-65.02283333
7	-64.64184615
7	-64.292
7	-63.66576923
7	-62.89969231
7	-62.1008
7	-60.51233333
7	-59.817
}\outlierdatatableb

% \definecolor{palette1}{RGB}{215,25,28}
% \definecolor{palette2}{RGB}{253,174,97}
% % \definecolor{palette3}{RGB}{255,255,191}
% \definecolor{palette3}{RGB}{208,28,139}
% \definecolor{palette4}{RGB}{184,225,134}
% % \definecolor{palette4}{RGB}{171,221,164}
% \definecolor{palette5}{RGB}{43,131,186}
% \definecolor{palette6}{RGB}{208,28,139}

% green -- blueish
% \definecolor{palette1}{RGB}{0,109,44}
% \definecolor{palette2}{RGB}{44,162,95}
% \definecolor{palette3}{RGB}{67,162,202}
% \definecolor{palette4}{RGB}{8,104,172}
% \definecolor{palette5}{RGB}{8,81,156}

%\definecolor{myred}{RGB}{202,0,32}
%\definecolor{myorange}{RGB}{244,165,130}
%\definecolor{myviolet}{RGB}{194,165,207}
%\definecolor{mycyan}{RGB}{146,197,222}
%\definecolor{myblue}{RGB}{5,113,176}
%\definecolor{mygreen}{RGB}{127,191,123}
%\definecolor{mytile}{RGB}{27,120,55}
%\definecolor{myblack}{RGB}{60,60,60}
%% \definecolor{palette3}{RGB}{247,247,247}

\definecolor{myblue}{HTML}{0070C0}
\definecolor{myred}{HTML}{C00000}
\definecolor{mypurple}{HTML}{7030A0}
\definecolor{mygreen}{HTML}{00B050}


% \documentclass{standalone}
\usepackage{pgfplots}
% Nice color sets, see see http://colorbrewer2.org/	
\usepgfplotslibrary{colorbrewer}
% initialize Set1-4 from colorbrewer (we're comparing 4 classes),
\pgfplotsset{compat = 1.15, cycle list/Set1-8} 
% Tikz is loaded automatically by pgfplots
\usetikzlibrary{pgfplots.statistics, pgfplots.colorbrewer} 
% provides \pgfplotstabletranspose
\usepackage{pgfplotstable}
\usepackage{filecontents}

\begin{document}

%\begin{tikzpicture}[font=\sffamily]
\begin{tikzpicture}
	
\begin{axis}[
    %ymode = log,
    boxplot/draw direction=y,
    ymax    = -55,
    ymin    = -120,
    xmax    = 7.5,%12.5,
    xmin    = 0.5,
    width   =  4.5 cm,
    height  =  2.5cm,
    scale only axis = true,
    xtick align = inside,
    % bar width   = 1pt,
    % enlarge x limits = auto,
    % xticklabel style = {
    %     font=\small,
    %     % at={(current axis.north west)},
    %     % rotate=-90,
    %     % xshift=-1ex,
    %     yshift = 2pt,
    % },
    tick label style={/pgf/number format/assume math mode=true},
    xtick = {1.5, 4, 6.5},
    xticklabels = {All (D2), R1(R2), R4(D1)},
    %{\bf \texttt{D2}}, R1({\bf \texttt{D1}}), R4({\bf \texttt{D1}})},
    %xticklabels = {{\bf \texttt{D2}}, R1({\bf \texttt{D1}}), R4({\bf \texttt{D1}})},
    %ytick = {1, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 200, 300, 400},
    %yticklabels = {1, 10, , , , , , , , , 100, , , 400},
    ytick = {-120, -110, ..., -60}, 
    yticklabels = {-120, -110, ..., -60},  
    %ytick = {1, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 200, 300, 400},
    %yticklabels =   {1, 10, , , , , , , , , 100, , , 400},
    %xticklabel style = {font=\small},
    %yticklabel style = {font=\small},
    boxplot/variable width,
    boxplot/box extend=0.9,
    % % xticklabel pos=right,
    % xtick pos = left,
    % ytick pos = left,
    % % yticklabel pos=right,
    % % enlargelimits=0.15,
    ylabel={RSRP (dBm)},
    %xlabel={BW \small{(MHz)}},
    xlabel style={
        %font=\small,
        % at={(current axis.north west)},
        % rotate=-90,
       % xshift= -10pt,
        yshift = 5pt,
    },
    ylabel style={
        %font=\small,
        % at={(current axis.north west)},
        % rotate=-90,
        %text width=2.8cm,
        align=center,
        xshift= 3pt,
        yshift = -8 pt,
    },
  yticklabel style={
        %font=\small,
        align=center,
        xshift= 3 pt,
        yshift = 3 pt,
    },
  xticklabel style={
        %font=\small,
        align=center,
        xshift= 0pt,
        yshift = 3pt,
    },
legend style={
	at      = {(0, 1)},
	font    = \normalsize,
	fill    = none,
	draw    = none,
	anchor  = north west,
	legend cell align   = left,
	legend columns      = 1,
},
%    xlabel style={
%        font=\large,
%        % at={(current axis.north west)},
%        % rotate=-90,
%        % xshift=-1ex,
%        xshift = 0 pt,
%        yshift = 3pt,
%    },
    % symbolic x coords={att, tmo, sprint, cmcc, fi},
    % xticklabels={AT\&T, T-Mobile, Sprint, China Mobile, Google-Fi},
    % xtick=data,
    % nodes near coords,
    % nodes near coords align={vertical},
        cycle list={{myred},{myblue}},
    ]
    
%		\foreach \n in {1,...,3} {
%			\addplot+[boxplot, fill, draw=black] table[y index=\n] {\datatransposed};
%		}    

%\pgfplotstablegetrowsof{\datatable}
%\pgfmathtruncatemacro\TotalRows{\pgfplotsretval-1}
%\pgfplotsinvokeforeach{0,...,\TotalRows}
%{
%	\addplot+[
%	boxplot prepared from table={
%		table=\datatable,
%		row=#1,
%		lower whisker=lw,
%		upper whisker=uw,
%		lower quartile=lq,
%		upper quartile=uq,
%		median=med
%	},
%	boxplot prepared={
%		every box/.style={thick,black,solid},
%		every whisker/.style={very thin,black,solid},
%		every median/.style={very thick,blue,solid},},
%	% to get a more useful legend
%	area legend
%	]
%	coordinates {};
%	% add legend entry 
%	%\pgfplotstablegetelem{#1}{name}\of\datatable
%	%\addlegendentryexpanded{\pgfplotsretval}
%}

\pgfplotstablegetrowsof{\datatablea}
\pgfmathtruncatemacro\TotalRows{\pgfplotsretval-1}
\pgfplotsinvokeforeach{0,...,\TotalRows}
{
	\addplot+[
	boxplot prepared from table={
		table=\datatablea,
		row=#1,
		lower whisker=lw,
		upper whisker=uw,
		lower quartile=lq,
		upper quartile=uq,
		median=med,
		%draw position = 1
	},
	boxplot prepared={
		draw position=#1 * 2.5 + 1,
		%		every box/.style={thick,black,solid},
		%		every whisker/.style={very thin,black,solid},
		%		every median/.style={very thick,blue,solid},},
	every box/.style={thick,myred,solid},
	every whisker/.style={very thin,myred,solid},
	every median/.style={very thick,myred,solid},},
fill,fill opacity=0.1,
% to get a more useful legend
area legend
]
coordinates {};
add legend entry 
%\pgfplotstablegetelem{#1}{name}\of\datatable
%\addlegendentryexpanded{\pgfplotsretval}
}

\pgfplotstablegetrowsof{\datatableb}
\pgfmathtruncatemacro\TotalRows{\pgfplotsretval-1}
\pgfplotsinvokeforeach{0,...,\TotalRows}
{
	\addplot+[
	boxplot prepared from table={
		table=\datatableb,
		row=#1,
		lower whisker=lw,
		upper whisker=uw,
		lower quartile=lq,
		upper quartile=uq,
		median=med,
		%draw position = 1
	},
	boxplot prepared={
		draw position=#1 * 2.5 + 2,
		%		every box/.style={thick,black,solid},
		%		every whisker/.style={very thin,black,solid},
		%		every median/.style={very thick,blue,solid},},
	every box/.style={thick,myblue,solid},
	every whisker/.style={very thin,myblue,solid},
	every median/.style={very thick,myblue,solid},},
fill,fill opacity=0.1,
% to get a more useful legend
area legend
]
coordinates {};
add legend entry 
%\pgfplotstablegetelem{#1}{name}\of\datatable
%\addlegendentryexpanded{\pgfplotsretval}
}

%\node[text=black] at (axis cs:2,260) {\bf 1};
%\node[text=black] at (axis cs:6,260) {\bf 2};
%\node[text=black] at (axis cs:10,260) {\bf 3};
%\node[text=black] at (axis cs:14,260) {\bf 4};
%\node[text=black] at (axis cs:18,260) {\bf 5};
%\node[text=black] at (axis cs:22,260) {\bf 6};
%\node[text=black] at (axis cs:26,260) {\bf 7};
%\node[text=black] at (axis cs:30,260) {\bf 8};
%\node[text=black] at (axis cs:34,260) {\bf 9};
%\node[text=black] at (axis cs:38,260) {\bf 10};
%\node[text=black] at (axis cs:42,260) {\bf 11};
%\node[text=black] at (axis cs:46,260) {\bf 12};
%\node[text=black] at (axis cs:50,260) {\bf 13};

\addplot[only marks,draw=myred,fill=white,mark=*,mark size=1pt,fill opacity=0.2] table[x=x,y=y] \outlierdatatablea;
\addplot[only marks,draw=myblue,fill=white,mark=*,mark size=1pt,fill opacity=0.2] table[x=x,y=y] \outlierdatatableb;

%\filldraw [draw=myred, fill = myred,fill opacity=0.1, thick] (1,-66) rectangle (2.3,-62);
%\node[,right] at (axis cs: 2.3,-64) {\normalsize Failure};
%
%\filldraw [draw=myblue, fill = myblue,fill opacity=0.1, thick] (1,-74) rectangle (2.3,-70);
%\node[,right] at (axis cs: 2.3,-72) {\normalsize Normal};

\legend{\texttt{Failure}, \texttt{Normal}}

%\addplot+[mark=none, densely dashed,gray,line width=0.5pt] coordinates {(3,-150) (3,0)};
%\addplot+[mark=none, densely dashed,gray,line width=0.5pt] coordinates {(6,-150) (6,0)};

%\legend{before, after}

%\filldraw [draw=myred, fill = myred,fill opacity=0.1, thick] (1.4,105) rectangle (2,115);
%\node[,right] at (axis cs: 2,110) {\normalsize U};
%
%\filldraw [draw=myblue, fill = myblue,fill opacity=0.1, thick] (3.4,105) rectangle (4,115);
%\node[,right] at (axis cs: 4,110) {\normalsize Others};


%\addplot+[mark=none, densely dashed,gray,line width=0.2pt] coordinates {(0,300) (4,300)};
%\node[,right] at (axis cs: 1.25, 400) {\small 300 Mbps};

% replot median in RED
%\addplot+[mark=none, very thick,solid,red] coordinates {(0.75,13.3) (1.25,13.3)};
%\addplot+[mark=none, very thick,solid,red] coordinates {(1.75,23.9) (2.25,23.9)};
%\addplot+[mark=none, very thick,solid,blue] coordinates {(2.75,165.1) (3.25,165.1)};


%\draw[gray,densely dashed,->,line width=0.2pt] (axis cs:1.25,13) -- (axis cs: 1.5,1.5);
%\node[,right] at (axis cs: 1.25,1.5) {\small 13.0};
%\draw[gray,densely dashed,->,line width=0.2pt] (axis cs:2.75,21.8) -- (axis cs: 3,6);
%\node[,right] at (axis cs: 2,6) {\small 21.8};
%\node[,right] at (axis cs: 1,300) {\small 164.5};

%\addplot+[mark=none, densely dashed,red,line width=0.2pt] coordinates {(0,13.3) (1.25,13.3)};
%\addplot+[mark=none, densely dashed,red,line width=0.2pt] coordinates {(2,23.9) (2.75,23.9)};
%\addplot+[mark=none, densely dashed,blue,line width=0.2pt] coordinates {(2.25,165.1) (3.5,165.1)};
%
%\draw[red,densely dashed,line width=0.2pt] (axis cs:1.25,13.3) -- (axis cs: 1.5,3);
%\node[red,right] at (axis cs: 1,2) {\small 13.3};
%\draw[red,densely dashed,line width=0.2pt] (axis cs:2.75,23.9) -- (axis cs: 3,7);
%\node[red,right] at (axis cs: 2,6) {\small 23.9};
%\draw[blue,densely dashed,line width=0.2pt] (axis cs:2.25,165.1) -- (axis cs: 1.5,300);
%\node[blue,right] at (axis cs: 1, 340) {\small 165.1};

%13
%21.8
%164.5

%\addplot+ [onlymarks,draw=black,mark=*,mark size=0.5pt,mark options={fill=black,},
%]table[x=x,y=y] \outlierdatatable;
%coordinates { 
%	(1,0)
%	(1, 100)
%	(2, 100)
%	(2, 100)
%};


\end{axis}
\end{tikzpicture}

\end{document}

