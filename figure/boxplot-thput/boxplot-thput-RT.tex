% Template for a CDF graph
%
% Author: Zengwen Yuan
% Version: 1.0  2017-03-08 init version
% Note: to use package fontspec,
% use XeLaTeX to compile

\documentclass{standalone}
\usepackage{siunitx}
% \usepackage{tikz}
\usepackage{pgfplots}
\usepackage{pgfplotstable}
%\usepackage{verbatim}
\usepackage{tikz}
\usepackage{helvet,etoolbox}
%\usepackage{sansmath}
\usepackage[active,tightpage]{preview}
\PreviewEnvironment{tikzpicture}
\setlength\PreviewBorder{1pt}
\usetikzlibrary{patterns}
\usetikzlibrary{pgfplots.statistics}

\pgfplotsset{compat=newest}

%\usepackage{fontspec}
%\setmainfont[
%BoldFont={Arial Bold},
%ItalicFont={Arial Italic},
%BoldItalicFont={Arial Bold Italic}
%]{Arial}

%\AtBeginEnvironment{tikzpicture}{\sansmath}
%\AtEndEnvironment{tikzpicture}{\unsansmath}

% # user-study-sync-overhead-context-tx-v2.txt
%\pgfplotstableread{
%0   0
%1000   0.1
%5000   0.8
%10000   0.95
%20000   1
%}{\fakedata}

\makeatletter
\pgfplotsset{
my filter/.style args={every#1between#2and#3}{%
/pgfplots/x filter/.append code={%
\ifnum\coordindex<#2%
  % Nothing
\else% Did we pass #3?
  \ifnum\coordindex>#3%
    %Nothing
  \else% Ok filter is on, don't disturb \pgfmathresult for convenience
    \pgfmathsetmacro\temp{int(mod(\coordindex,#1))}%
    \ifnum0=\temp\relax% Are we on the nth point?
      % Yes do nothing let it pass
    \else% discard it
      \let\pgfmathresult\pgfutil@empty
    \fi%
  \fi%
\fi%
}}}
\makeatother



\pgfplotsset{
    compat=newest,
    legend image code/.code={
        \draw[mark repeat=2,mark phase=2]
        plot coordinates {
            (0cm,0cm)
            (0.3cm,0cm)        %% default is (0.3cm,0cm)
            (0.6cm,0cm)         %% default is (0.6cm,0cm)
        };%
    }
}

\makeatletter
\pgfplotsset{
	boxplot prepared from table/.code={
		\def\tikz@plot@handler{\pgfplotsplothandlerboxplotprepared}%
		\pgfplotsset{
			/pgfplots/boxplot prepared from table/.cd,
			#1,
		}
	},
	/pgfplots/boxplot prepared from table/.cd,
	table/.code={\pgfplotstablecopy{#1}\to\boxplot@datatable},
	row/.initial=0,
	make style readable from table/.style={
		#1/.code={
			\pgfplotstablegetelem{\pgfkeysvalueof{/pgfplots/boxplot prepared from table/row}}{##1}\of\boxplot@datatable
			\pgfplotsset{boxplot/#1/.expand once={\pgfplotsretval}}
		}
	},
	make style readable from table=lower whisker,
	make style readable from table=upper whisker,
	make style readable from table=lower quartile,
	make style readable from table=upper quartile,
	make style readable from table=median,
	make style readable from table=lower notch,
	make style readable from table=upper notch,
}
\makeatother

\pgfplotstableread{
	lw lq med  uq uw
9.574992000000002 18.294151999999997 42.076704 92.801864 197.5472768
0.371872 2.205888 9.6704 16.600768000000002 26.581856
10000 10000 10000 10000 10000
0.6747200000000001 2.252316 7.56896 16.856 35.62243840000003
0.8752800000000001 2.3446 5.064688 10.638764 20.762544
}\datatable

\pgfplotstableread{
lw lq med  uq uw
3.4295824 27.530836 58.852503999999996 127.767044 201.13380000000004
29.3513088 39.976464 57.685056 64.770816 69.022272
35.3857472 39.94964 61.095712000000006 91.76294399999999 155.63039039999998
0.6747200000000001 2.252316 7.568959999999999 16.856 35.62243840000003
9.574992000000002 18.294151999999997 42.076704 92.801864 197.5472768
}\datatablea

\pgfplotstableread{
lw lq med  uq uw
8.934153600000002 19.749144 29.00664 39.7177 52.3487504
0.879424 1.712256 10.410544 20.80716 33.591167999999996
7.214892800000002 17.03112 38.013792 78.57419200000001 128.93713919999993
0.8752800000000002 2.3446 5.064688 10.638763999999998 20.76254400000001
0.371872 2.2058880000000003 9.6704 16.600768000000002 26.581856000000005
}\datatableb

\pgfplotstableread{
	x y
1	0
1	0
1	0.66728
1	2.32632
1	2.646128
1	3.427552
1	211.780368
1	220.074016
1	224.160368
1	280.05808
1	328.49464
1	413.066784
3.5	 22.267872
3.5	 71.856576
6	12.395456
6	218.86128
8.5	0.192
8.5	0.247088
8.5	0.279936
8.5	0.337808
8.5	0.340288
8.5	0.5576
8.5	43.6608
8.5	46.732432
8.5	49.625984
8.5	51.9296
8.5	57.8768
8.5	85.0672
9.5	0
9.5	0.70432
9.5	0.8288
11	1.264736
11	3.9824
11	5.576
11	9.34608
11	198.097024
11	205.266496
11	207.130848
11	230.808976
11	241.2808
11	273.454616
11	287.446688
}\outlierdatatablea

\pgfplotstableread{
	x y
2	0
2	0.011568
2	0.092544
2	0.761312
2	2.230496
2	3.219624
2	4.392416
2	5.019056
2	5.857776
2	7.732
2	8.480688
2	52.378016
2	53.815888
2	55.032624
2	56.02696
2	56.379184
2	57.416528
2	58.840256
2	61.142352
2	69.185376
2	82.732752
2	148.857328
4.5 	 0.314496
4.5 	 0.69888
4.5 	 0.733824
4.5 	 36.376704
4.5 	47.4656
4.5 	 51.740416
7	4.690176
7	6.81904
7	232.42528
7	252.528224
9.5	0
9.5	0.184
9.5	0.184
9.5	0.2768
9.5	0.3792
9.5	0.45168
9.5	0.473888
9.5	0.6592
9.5	0.6616
9.5	0.7488
9.5	0.84
9.5	20.8176
9.5	20.9736
9.5	21.335552
9.5	22.511792
9.5	23.464
9.5	23.58
9.5	25.9664
9.5	26.2608
9.5	27.066624
9.5	28.04656
12	0
12	0
12	0.0128
12	0.039584
12	0.24128
12	27.06304
12	32.047584
12	40.394808
12	41.73664
12	137.200064
}\outlierdatatableb

% \definecolor{palette1}{RGB}{215,25,28}
% \definecolor{palette2}{RGB}{253,174,97}
% % \definecolor{palette3}{RGB}{255,255,191}
% \definecolor{palette3}{RGB}{208,28,139}
% \definecolor{palette4}{RGB}{184,225,134}
% % \definecolor{palette4}{RGB}{171,221,164}
% \definecolor{palette5}{RGB}{43,131,186}
% \definecolor{palette6}{RGB}{208,28,139}

% green -- blueish
% \definecolor{palette1}{RGB}{0,109,44}
% \definecolor{palette2}{RGB}{44,162,95}
% \definecolor{palette3}{RGB}{67,162,202}
% \definecolor{palette4}{RGB}{8,104,172}
% \definecolor{palette5}{RGB}{8,81,156}

%\definecolor{myred}{RGB}{202,0,32}
%\definecolor{myorange}{RGB}{244,165,130}
%\definecolor{myviolet}{RGB}{194,165,207}
%\definecolor{mycyan}{RGB}{146,197,222}
%\definecolor{myblue}{RGB}{5,113,176}
%\definecolor{mygreen}{RGB}{127,191,123}
%\definecolor{mytile}{RGB}{27,120,55}
%\definecolor{myblack}{RGB}{60,60,60}
%% \definecolor{palette3}{RGB}{247,247,247}

\definecolor{myblue}{HTML}{0070C0}
\definecolor{myred}{HTML}{C00000}
\definecolor{mypurple}{HTML}{7030A0}
\definecolor{mygreen}{HTML}{00B050}


% \documentclass{standalone}
\usepackage{pgfplots}
% Nice color sets, see see http://colorbrewer2.org/	
\usepgfplotslibrary{colorbrewer}
% initialize Set1-4 from colorbrewer (we're comparing 4 classes),
\pgfplotsset{compat = 1.15, cycle list/Set1-8} 
% Tikz is loaded automatically by pgfplots
\usetikzlibrary{pgfplots.statistics, pgfplots.colorbrewer} 
% provides \pgfplotstabletranspose
\usepackage{pgfplotstable}
\usepackage{filecontents}

\begin{document}

%\begin{tikzpicture}[font=\sffamily]
\begin{tikzpicture}
	
\begin{axis}[
    %ymode = log,
    boxplot/draw direction=y,
    ymax    = 210,
    ymin    = 0,
    xmax    = 12.5,
    xmin    = 0.5,
    width   =  10 cm,
    height  =  2.5 cm,
    scale only axis = true,
    xtick align = inside,
    % bar width   = 1pt,
    % enlarge x limits = auto,
    % xticklabel style = {
    %     font=\small,
    %     % at={(current axis.north west)},
    %     % rotate=-90,
    %     % xshift=-1ex,
    %     yshift = 2pt,
    % },
    tick label style={/pgf/number format/assume math mode=true},
    xtick = {1.5, 4, 6.5, 9, 11.5},
    xticklabels = {\textbf{A(D1)}, \textbf{T(D1)}, \textbf{V(D1)}, \textbf{A(D2)}, \textbf{T(D2)}},
    %ytick = {1, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 200, 300, 400},
    %yticklabels = {1, 10, , , , , , , , , 100, , , 400},
    ytick = {0, 50, ..., 200}, 
    yticklabels = {0, 50, ..., 200},  
    %ytick = {1, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 200, 300, 400},
    %yticklabels =   {1, 10, , , , , , , , , 100, , , 400},
    %xticklabel style = {font=\small},
    %yticklabel style = {font=\small},
    boxplot/variable width,
    boxplot/box extend=0.9,
    % % xticklabel pos=right,
    % xtick pos = left,
    % ytick pos = left,
    % % yticklabel pos=right,
    % % enlargelimits=0.15,
    ylabel={DL Thput (Mbps)},
   % xlabel={D1 \hfill D2},
    xlabel style={
        %font=\small,
        % at={(current axis.north west)},
        % rotate=-90,
       % xshift= -10pt,
        yshift = 5pt,
    },
   yticklabel style = {
    %font=\normalsize,
   	yshift =  0 pt,
        xshift =  3 pt,
    },
       xticklabel style = {
    %font=\normalsize,
   	yshift =  2 pt,
        xshift =  0 pt,
    },
    ylabel style={
        %font=\small,
        % at={(current axis.north west)},
        % rotate=-90,
        %text width=2.8cm,
        align=center,
        xshift= -3pt,
        yshift = -8 pt,
    },
legend style={
	at      = {(0.14, 1)},
	font    = \normalsize,
	fill    = none,
	draw    = none,
	anchor  = north west,
	legend cell align   = left,
	legend columns      = 1,
},
%    xlabel style={
%        font=\large,
%        % at={(current axis.north west)},
%        % rotate=-90,
%        % xshift=-1ex,
%        xshift = 0 pt,
%        yshift = 3pt,
%    },
    % symbolic x coords={att, tmo, sprint, cmcc, fi},
    % xticklabels={AT\&T, T-Mobile, Sprint, China Mobile, Google-Fi},
    % xtick=data,
    % nodes near coords,
    % nodes near coords align={vertical},
    cycle list={{myred},{myblue}},
    ]
    
%		\foreach \n in {1,...,3} {
%			\addplot+[boxplot, fill, draw=black] table[y index=\n] {\datatransposed};
%		}    

%\pgfplotstablegetrowsof{\datatable}
%\pgfmathtruncatemacro\TotalRows{\pgfplotsretval-1}
%\pgfplotsinvokeforeach{0,...,\TotalRows}
%{
%	\addplot+[
%	boxplot prepared from table={
%		table=\datatable,
%		row=#1,
%		lower whisker=lw,
%		upper whisker=uw,
%		lower quartile=lq,
%		upper quartile=uq,
%		median=med
%	},
%	boxplot prepared={
%		every box/.style={thick,black,solid},
%		every whisker/.style={very thin,black,solid},
%		every median/.style={very thick,blue,solid},},
%	% to get a more useful legend
%	area legend
%	]
%	coordinates {};
%	% add legend entry 
%	%\pgfplotstablegetelem{#1}{name}\of\datatable
%	%\addlegendentryexpanded{\pgfplotsretval}
%}

\pgfplotstablegetrowsof{\datatablea}
\pgfmathtruncatemacro\TotalRows{\pgfplotsretval-1}
\pgfplotsinvokeforeach{0,...,\TotalRows}
{
	\addplot+[
	boxplot prepared from table={
		table=\datatablea,
		row=#1,
		lower whisker=lw,
		upper whisker=uw,
		lower quartile=lq,
		upper quartile=uq,
		median=med,
		%draw position = 1
	},
	boxplot prepared={
		draw position=#1 * 2.5 + 1,
		%		every box/.style={thick,black,solid},
		%		every whisker/.style={very thin,black,solid},
		%		every median/.style={very thick,blue,solid},},
	every box/.style={thick,myred,solid},
	every whisker/.style={very thin,myred,solid},
	every median/.style={very thick,myred,solid},},
fill,fill opacity=0.1,
% to get a more useful legend
area legend
]
coordinates {};
add legend entry 
%\pgfplotstablegetelem{#1}{name}\of\datatable
%\addlegendentryexpanded{\pgfplotsretval}
}

\pgfplotstablegetrowsof{\datatableb}
\pgfmathtruncatemacro\TotalRows{\pgfplotsretval-1}
\pgfplotsinvokeforeach{0,...,\TotalRows}
{
	\addplot+[
	boxplot prepared from table={
		table=\datatableb,
		row=#1,
		lower whisker=lw,
		upper whisker=uw,
		lower quartile=lq,
		upper quartile=uq,
		median=med,
		%draw position = 1
	},
	boxplot prepared={
		draw position=#1 * 2.5 + 2,
		%		every box/.style={thick,black,solid},
		%		every whisker/.style={very thin,black,solid},
		%		every median/.style={very thick,blue,solid},},
	every box/.style={thick,myblue,solid},
	every whisker/.style={very thin,myblue,solid},
	every median/.style={very thick,myblue,solid},},
fill,fill opacity=0.1,
% to get a more useful legend
area legend
]
coordinates {};
add legend entry 
%\pgfplotstablegetelem{#1}{name}\of\datatable
%\addlegendentryexpanded{\pgfplotsretval}
}

%\node[text=black] at (axis cs:2,260) {\bf 1};
%\node[text=black] at (axis cs:6,260) {\bf 2};
%\node[text=black] at (axis cs:10,260) {\bf 3};
%\node[text=black] at (axis cs:14,260) {\bf 4};
%\node[text=black] at (axis cs:18,260) {\bf 5};
%\node[text=black] at (axis cs:22,260) {\bf 6};
%\node[text=black] at (axis cs:26,260) {\bf 7};
%\node[text=black] at (axis cs:30,260) {\bf 8};
%\node[text=black] at (axis cs:34,260) {\bf 9};
%\node[text=black] at (axis cs:38,260) {\bf 10};
%\node[text=black] at (axis cs:42,260) {\bf 11};
%\node[text=black] at (axis cs:46,260) {\bf 12};
%\node[text=black] at (axis cs:50,260) {\bf 13};

\addplot[only marks,draw=myred,fill=white,mark=*,mark size=1pt,fill opacity=0.2] table[x=x,y=y] \outlierdatatablea;
\addplot[only marks,draw=myblue,fill=white,mark=*,mark size=1pt,fill opacity=0.2] table[x=x,y=y] \outlierdatatableb;

\legend{\texttt{RTMAX}, \texttt{Others}}

\addplot+[mark=none, densely dashed,gray,line width=0.5pt] coordinates {(7.8,0) (7.8,210)};
%\node[] at (axis cs: 6,180) {{\bf D1}};
%\node[] at (axis cs: 9.5,180) {{\bf D2}};

%\draw [decorate, decoration={brace,amplitude=5pt,raise=1pt}] (1,150) -- (8,150) node [midway, anchor=north, yshift=10mm, outer sep=10pt,font=\small]{{\bf D1}};
%
%\draw [decorate, decoration={brace,amplitude=5pt,raise=1pt}] (10,150) -- (14,150) node [midway, anchor=north, yshift=10mm, outer sep=10pt,font=\small]{{\bf D2}};

%\filldraw [draw=myred, fill = myred,fill opacity=0.1, thick] (1.4,350) rectangle (2,700);
%\node[,right] at (axis cs: 2,500) {\normalsize RT};
%
%\filldraw [draw=myblue, fill = myblue,fill opacity=0.1, thick] (3.4,350) rectangle (4,700);
%\node[,right] at (axis cs: 4,500) {\normalsize Others};



%\node[,right] at (axis cs: 1.25, 400) {\small 300 Mbps};

% replot median in RED
%\addplot+[mark=none, very thick,solid,red] coordinates {(0.75,13.3) (1.25,13.3)};
%\addplot+[mark=none, very thick,solid,red] coordinates {(1.75,23.9) (2.25,23.9)};
%\addplot+[mark=none, very thick,solid,blue] coordinates {(2.75,165.1) (3.25,165.1)};


%\draw[gray,densely dashed,->,line width=0.2pt] (axis cs:1.25,13) -- (axis cs: 1.5,1.5);
%\node[,right] at (axis cs: 1.25,1.5) {\small 13.0};
%\draw[gray,densely dashed,->,line width=0.2pt] (axis cs:2.75,21.8) -- (axis cs: 3,6);
%\node[,right] at (axis cs: 2,6) {\small 21.8};
%\node[,right] at (axis cs: 1,300) {\small 164.5};

%\addplot+[mark=none, densely dashed,red,line width=0.2pt] coordinates {(0,13.3) (1.25,13.3)};
%\addplot+[mark=none, densely dashed,red,line width=0.2pt] coordinates {(2,23.9) (2.75,23.9)};
%\addplot+[mark=none, densely dashed,blue,line width=0.2pt] coordinates {(2.25,165.1) (3.5,165.1)};
%
%\draw[red,densely dashed,line width=0.2pt] (axis cs:1.25,13.3) -- (axis cs: 1.5,3);
%\node[red,right] at (axis cs: 1,2) {\small 13.3};
%\draw[red,densely dashed,line width=0.2pt] (axis cs:2.75,23.9) -- (axis cs: 3,7);
%\node[red,right] at (axis cs: 2,6) {\small 23.9};
%\draw[blue,densely dashed,line width=0.2pt] (axis cs:2.25,165.1) -- (axis cs: 1.5,300);
%\node[blue,right] at (axis cs: 1, 340) {\small 165.1};

%13
%21.8
%164.5

%\addplot+ [onlymarks,draw=black,mark=*,mark size=0.5pt,mark options={fill=black,},
%]table[x=x,y=y] \outlierdatatable;
%coordinates { 
%	(1,0)
%	(1, 100)
%	(2, 100)
%	(2, 100)
%};


\end{axis}
\end{tikzpicture}

\end{document}

