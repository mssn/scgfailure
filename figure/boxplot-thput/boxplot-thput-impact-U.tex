% Template for a CDF graph
%
% Author: Zengwen Yuan
% Version: 1.0  2017-03-08 init version
% Note: to use package fontspec,
% use XeLaTeX to compile

\documentclass{standalone}
\usepackage{siunitx}
% \usepackage{tikz}
\usepackage{pgfplots}
\usepackage{pgfplotstable}
%\usepackage{verbatim}
\usepackage{tikz}
\usepackage{helvet,etoolbox}
%\usepackage{sansmath}
\usepackage[active,tightpage]{preview}
\PreviewEnvironment{tikzpicture}
\setlength\PreviewBorder{1pt}
\usetikzlibrary{patterns}
\usetikzlibrary{pgfplots.statistics}

\pgfplotsset{compat=newest}

%\usepackage{fontspec}
%\setmainfont[
%BoldFont={Arial Bold},
%ItalicFont={Arial Italic},
%BoldItalicFont={Arial Bold Italic}
%]{Arial}

%\AtBeginEnvironment{tikzpicture}{\sansmath}
%\AtEndEnvironment{tikzpicture}{\unsansmath}

% # user-study-sync-overhead-context-tx-v2.txt
%\pgfplotstableread{
%0   0
%1000   0.1
%5000   0.8
%10000   0.95
%20000   1
%}{\fakedata}

\makeatletter
\pgfplotsset{
my filter/.style args={every#1between#2and#3}{%
/pgfplots/x filter/.append code={%
\ifnum\coordindex<#2%
  % Nothing
\else% Did we pass #3?
  \ifnum\coordindex>#3%
    %Nothing
  \else% Ok filter is on, don't disturb \pgfmathresult for convenience
    \pgfmathsetmacro\temp{int(mod(\coordindex,#1))}%
    \ifnum0=\temp\relax% Are we on the nth point?
      % Yes do nothing let it pass
    \else% discard it
      \let\pgfmathresult\pgfutil@empty
    \fi%
  \fi%
\fi%
}}}
\makeatother



\pgfplotsset{
    compat=newest,
    legend image code/.code={
        \draw[mark repeat=2,mark phase=2]
        plot coordinates {
            (0cm,0cm)
            (0.3cm,0cm)        %% default is (0.3cm,0cm)
            (0.6cm,0cm)         %% default is (0.6cm,0cm)
        };%
    }
}

\makeatletter
\pgfplotsset{
	boxplot prepared from table/.code={
		\def\tikz@plot@handler{\pgfplotsplothandlerboxplotprepared}%
		\pgfplotsset{
			/pgfplots/boxplot prepared from table/.cd,
			#1,
		}
	},
	/pgfplots/boxplot prepared from table/.cd,
	table/.code={\pgfplotstablecopy{#1}\to\boxplot@datatable},
	row/.initial=0,
	make style readable from table/.style={
		#1/.code={
			\pgfplotstablegetelem{\pgfkeysvalueof{/pgfplots/boxplot prepared from table/row}}{##1}\of\boxplot@datatable
			\pgfplotsset{boxplot/#1/.expand once={\pgfplotsretval}}
		}
	},
	make style readable from table=lower whisker,
	make style readable from table=upper whisker,
	make style readable from table=lower quartile,
	make style readable from table=upper quartile,
	make style readable from table=median,
	make style readable from table=lower notch,
	make style readable from table=upper notch,
}
\makeatother

\pgfplotstableread{
	lw lq med  uq uw
13.858717760000001 25.466401 74.798704 161.8519868 208.90701896000002
0.9277541600000001 3.0722694 6.633240000000001 8.7659696 18.496647999999997
10000 10000 10000 10000 10000
79.82923872 82.6162392 87.26124 92.067976 94.9520176
10.84291776 32.3984612 104.9110864 140.95336279999998 212.24723600000007
2.65531072 4.0868548 14.1995632 28.9211234 48.146425279999995
}\datatable

\pgfplotstableread{
	lw lq med  uq uw
	10.84291776 32.3984612 104.9110864 140.95336279999998 212.24723600000007
		0.9277541600000001 3.0722694 6.633240000000001 8.7659696 18.496647999999997
}\datatablea

\pgfplotstableread{
	lw lq med  uq uw
	79.82923872 82.6162392 87.26124 92.067976 94.9520176
	13.858717760000001 25.466401 74.798704 161.8519868 208.90701896000002
}\datatableb

\pgfplotstableread{
	lw lq med  uq uw
	2.65531072 4.0868548 14.1995632 28.9211234 48.146425279999995
	10000 10000 10000 10000 10000
}\datatablec

\pgfplotstableread{
	x y
1	5.6513296
1	10.454184
1	10.5581808
1	235.3117256
1	273.7725824
1	308.9271832
4.5	0.096404
4.5	0.41936
4.5	0.7915688
4.5	19.82272
4.5	25.41384
4.5	54.6016264
}\outlierdatatablea

\pgfplotstableread{
x y
2	77.9712384
2	96.874712
5.5	1.7749424
5.5	2.9304792
5.5	3.0708392
5.5	4.2209304
5.5	12.5787392
5.5	212.3724944
5.5	224.2198056
5.5	233.6172968
5.5	235.0695584
5.5	324.9978824
}\outlierdatatableb

\pgfplotstableread{
	x y
3	0.7443776
3	1.2741376
3	2.4825472
3	49.7372024
3	65.753748
3	97.3862184
}\outlierdatatablec

% \definecolor{palette1}{RGB}{215,25,28}
% \definecolor{palette2}{RGB}{253,174,97}
% % \definecolor{palette3}{RGB}{255,255,191}
% \definecolor{palette3}{RGB}{208,28,139}
% \definecolor{palette4}{RGB}{184,225,134}
% % \definecolor{palette4}{RGB}{171,221,164}
% \definecolor{palette5}{RGB}{43,131,186}
% \definecolor{palette6}{RGB}{208,28,139}

% green -- blueish
% \definecolor{palette1}{RGB}{0,109,44}
% \definecolor{palette2}{RGB}{44,162,95}
% \definecolor{palette3}{RGB}{67,162,202}
% \definecolor{palette4}{RGB}{8,104,172}
% \definecolor{palette5}{RGB}{8,81,156}

%\definecolor{myred}{RGB}{202,0,32}
%\definecolor{myorange}{RGB}{244,165,130}
%\definecolor{myviolet}{RGB}{194,165,207}
%\definecolor{mycyan}{RGB}{146,197,222}
%\definecolor{myblue}{RGB}{5,113,176}
%\definecolor{mygreen}{RGB}{127,191,123}
%\definecolor{mytile}{RGB}{27,120,55}
%\definecolor{myblack}{RGB}{60,60,60}
%% \definecolor{palette3}{RGB}{247,247,247}

\definecolor{myblue}{HTML}{0070C0}
\definecolor{myred}{HTML}{C00000}
\definecolor{mypurple}{HTML}{7030A0}
\definecolor{mygreen}{HTML}{00B050}


% \documentclass{standalone}
\usepackage{pgfplots}
% Nice color sets, see see http://colorbrewer2.org/	
\usepgfplotslibrary{colorbrewer}
% initialize Set1-4 from colorbrewer (we're comparing 4 classes),
\pgfplotsset{compat = 1.15, cycle list/Set1-8} 
% Tikz is loaded automatically by pgfplots
\usetikzlibrary{pgfplots.statistics, pgfplots.colorbrewer} 
% provides \pgfplotstabletranspose
\usepackage{pgfplotstable}
\usepackage{filecontents}

\begin{document}

%\begin{tikzpicture}[font=\sffamily]
\begin{tikzpicture}
	
\begin{axis}[
    %ymode = log,
    boxplot/draw direction=y,
    ymax    = 250,
    ymin    = 0,
    xmax    = 6,%12.5,
    xmin    = 0.5,
    width   =  4.9 cm,
    height  =  2.5 cm,
    scale only axis = true,
    xtick align = inside,
    % bar width   = 1pt,
    % enlarge x limits = auto,
    % xticklabel style = {
    %     font=\small,
    %     % at={(current axis.north west)},
    %     % rotate=-90,
    %     % xshift=-1ex,
    %     yshift = 2pt,
    % },
    tick label style={/pgf/number format/assume math mode=true},
    xtick = {1,2,3,4.5,5.5},
    %xticklabels = {T$_{D_2}$, A$_{D_2}$, T$_{D_1}$, A$_{D_1}$, V$_{D_1}$},
    %xticklabels = {{\bf \texttt{D1}}, {\bf \texttt{D2}}},
    xticklabels = {\textbf{A}, \textbf{T}, \textbf{V}, \textbf{A}, \textbf{T}},
    %ytick = {1, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 200, 300, 400},
    %yticklabels = {1, 10, , , , , , , , , 100, , , 400},
    ytick = {0, 50, ..., 200}, 
    yticklabels = {0, 50, ..., 200},  
    %ytick = {1, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 200, 300, 400},
    %yticklabels =   {1, 10, , , , , , , , , 100, , , 400},
    %xticklabel style = {font=\small},
    %yticklabel style = {font=\small},
    boxplot/variable width,
    boxplot/box extend=0.9,
    % % xticklabel pos=right,
    % xtick pos = left,
    % ytick pos = left,
    % % yticklabel pos=right,
    % % enlargelimits=0.15,
    ylabel={Abs. loss(Mbps)},
    %xlabel={BW \small{(MHz)}},
    xticklabel style={
    	%font=\small,
    	align=center,
    	xshift= 0pt,
    	yshift = 3pt,
    },
 yticklabel style={
	%font=\small,
	align=center,
	xshift= 3pt,
	yshift = 0pt,
},
    xlabel style={
        %font=\small,
        % at={(current axis.north west)},
        % rotate=-90,
       % xshift= -10pt,
        yshift = 5pt,
    },
    ylabel style={
        %font=\small,
        % at={(current axis.north west)},
        % rotate=-90,
        %text width=2.8cm,
        align=center,
        xshift=-3pt,
        yshift = -8pt,
    },
legend style={
	at      = {(0.9, 1)},
	font    = \normalsize,
	fill    = none,
	draw    = none,
	%anchor  = north west,
	legend cell align   = left,
	legend columns      = 3,
},
%    xlabel style={
%        font=\large,
%        % at={(current axis.north west)},
%        % rotate=-90,
%        % xshift=-1ex,
%        xshift = 0 pt,
%        yshift = 3pt,
%    },
    % symbolic x coords={att, tmo, sprint, cmcc, fi},
    % xticklabels={AT\&T, T-Mobile, Sprint, China Mobile, Google-Fi},
    % xtick=data,
    % nodes near coords,
    % nodes near coords align={vertical},
        cycle list={{myred},{myblue},{mypurple}},
    ]
    
%		\foreach \n in {1,...,3} {
%			\addplot+[boxplot, fill, draw=black] table[y index=\n] {\datatransposed};
%		}    

%\pgfplotstablegetrowsof{\datatable}
%\pgfmathtruncatemacro\TotalRows{\pgfplotsretval-1}
%\pgfplotsinvokeforeach{0,...,\TotalRows}
%{
%	\addplot+[
%	boxplot prepared from table={
%		table=\datatable,
%		row=#1,
%		lower whisker=lw,
%		upper whisker=uw,
%		lower quartile=lq,
%		upper quartile=uq,
%		median=med
%	},
%	boxplot prepared={
%		every box/.style={thick,black,solid},
%		every whisker/.style={very thin,black,solid},
%		every median/.style={very thick,blue,solid},},
%	% to get a more useful legend
%	area legend
%	]
%	coordinates {};
%	% add legend entry 
%	%\pgfplotstablegetelem{#1}{name}\of\datatable
%	%\addlegendentryexpanded{\pgfplotsretval}
%}

\pgfplotstablegetrowsof{\datatablea}
\pgfmathtruncatemacro\TotalRows{\pgfplotsretval-1}
\pgfplotsinvokeforeach{0,...,\TotalRows}
{
	\addplot+[
	boxplot prepared from table={
		table=\datatablea,
		row=#1,
		lower whisker=lw,
		upper whisker=uw,
		lower quartile=lq,
		upper quartile=uq,
		median=med,
		%draw position = 1
	},
	boxplot prepared={
		draw position=#1 * 3.5+ 1,
		%		every box/.style={thick,black,solid},
		%		every whisker/.style={very thin,black,solid},
		%		every median/.style={very thick,blue,solid},},
	every box/.style={thick,myred,solid},
	every whisker/.style={very thin,myred,solid},
	every median/.style={very thick,myred,solid},},
fill,fill opacity=0.1,
% to get a more useful legend
area legend
]
coordinates {};
add legend entry 
%\pgfplotstablegetelem{#1}{name}\of\datatable
%\addlegendentryexpanded{\pgfplotsretval}
}

\pgfplotstablegetrowsof{\datatableb}
\pgfmathtruncatemacro\TotalRows{\pgfplotsretval-1}
\pgfplotsinvokeforeach{0,...,\TotalRows}
{
\addplot+[
boxplot prepared from table={
	table=\datatableb,
	row=#1,
	lower whisker=lw,
	upper whisker=uw,
	lower quartile=lq,
	upper quartile=uq,
	median=med,
	%draw position = 1
},
boxplot prepared={
	draw position=#1 * 3.5 + 2,
	%		every box/.style={thick,black,solid},
	%		every whisker/.style={very thin,black,solid},
	%		every median/.style={very thick,blue,solid},},
every box/.style={thick,myblue,solid},
every whisker/.style={very thin,myblue,solid},
every median/.style={very thick,myblue,solid},},
fill,fill opacity=0.1,
% to get a more useful legend
area legend
]
coordinates {};
add legend entry 
%\pgfplotstablegetelem{#1}{name}\of\datatable
%\addlegendentryexpanded{\pgfplotsretval}
}

\pgfplotstablegetrowsof{\datatablec}
\pgfmathtruncatemacro\TotalRows{\pgfplotsretval-1}
\pgfplotsinvokeforeach{0,...,\TotalRows}
{
	\addplot+[
	boxplot prepared from table={
		table=\datatablec,
		row=#1,
		lower whisker=lw,
		upper whisker=uw,
		lower quartile=lq,
		upper quartile=uq,
		median=med,
		%draw position = 1
	},
	boxplot prepared={
		draw position=#1 * 3.5 + 3,
		%		every box/.style={thick,black,solid},
		%		every whisker/.style={very thin,black,solid},
		%		every median/.style={very thick,blue,solid},},
	every box/.style={thick,mypurple,solid},
	every whisker/.style={very thin,mypurple,solid},
	every median/.style={very thick,mypurple,solid},},
fill,fill opacity=0.1,
% to get a more useful legend
area legend
]
coordinates {};
add legend entry 
%\pgfplotstablegetelem{#1}{name}\of\datatable
%\addlegendentryexpanded{\pgfplotsretval}
}

%\node[text=black] at (axis cs:2,260) {\bf 1};
%\node[text=black] at (axis cs:6,260) {\bf 2};
%\node[text=black] at (axis cs:10,260) {\bf 3};
%\node[text=black] at (axis cs:14,260) {\bf 4};
%\node[text=black] at (axis cs:18,260) {\bf 5};
%\node[text=black] at (axis cs:22,260) {\bf 6};
%\node[text=black] at (axis cs:26,260) {\bf 7};
%\node[text=black] at (axis cs:30,260) {\bf 8};
%\node[text=black] at (axis cs:34,260) {\bf 9};
%\node[text=black] at (axis cs:38,260) {\bf 10};
%\node[text=black] at (axis cs:42,260) {\bf 11};
%\node[text=black] at (axis cs:46,260) {\bf 12};
%\node[text=black] at (axis cs:50,260) {\bf 13};

\addplot[only marks,draw=myred,fill=white,mark=*,mark size=1pt,fill opacity=0.2] table[x=x,y=y] \outlierdatatablea;
\addplot[only marks,draw=myblue,fill=white,mark=*,mark size=1pt,fill opacity=0.2] table[x=x,y=y] \outlierdatatableb;
\addplot[only marks,draw=mypurple,fill=white,mark=*,mark size=1pt,fill opacity=0.2] table[x=x,y=y] \outlierdatatablec;

%\legend{\textbf{T}, \textbf{A}, \textbf{V}}

%\filldraw [draw=myred, fill = myred,fill opacity=0.1, thick] (1.4,350) rectangle (2,700);
\node[] at (axis cs: 2,230) {\normalsize {\bf D1}};
\node[] at (axis cs: 5,230) {\normalsize {\bf D2}};

\addplot+[mark=none, densely dashed,gray,line width=0.5pt] coordinates {(3.75,0) (3.75,300)};

%
%\filldraw [draw=myblue, fill = myblue,fill opacity=0.1, thick] (3.4,350) rectangle (4,700);
%\node[,right] at (axis cs: 4,500) {\normalsize Others};


%\addplot+[mark=none, densely dashed,gray,line width=0.2pt] coordinates {(0,300) (4,300)};
%\node[,right] at (axis cs: 1.25, 400) {\small 300 Mbps};

% replot median in RED
%\addplot+[mark=none, very thick,solid,red] coordinates {(0.75,13.3) (1.25,13.3)};
%\addplot+[mark=none, very thick,solid,red] coordinates {(1.75,23.9) (2.25,23.9)};
%\addplot+[mark=none, very thick,solid,blue] coordinates {(2.75,165.1) (3.25,165.1)};


%\draw[gray,densely dashed,->,line width=0.2pt] (axis cs:1.25,13) -- (axis cs: 1.5,1.5);
%\node[,right] at (axis cs: 1.25,1.5) {\small 13.0};
%\draw[gray,densely dashed,->,line width=0.2pt] (axis cs:2.75,21.8) -- (axis cs: 3,6);
%\node[,right] at (axis cs: 2,6) {\small 21.8};
%\node[,right] at (axis cs: 1,300) {\small 164.5};

%\addplot+[mark=none, densely dashed,red,line width=0.2pt] coordinates {(0,13.3) (1.25,13.3)};
%\addplot+[mark=none, densely dashed,red,line width=0.2pt] coordinates {(2,23.9) (2.75,23.9)};
%\addplot+[mark=none, densely dashed,blue,line width=0.2pt] coordinates {(2.25,165.1) (3.5,165.1)};
%
%\draw[red,densely dashed,line width=0.2pt] (axis cs:1.25,13.3) -- (axis cs: 1.5,3);
%\node[red,right] at (axis cs: 1,2) {\small 13.3};
%\draw[red,densely dashed,line width=0.2pt] (axis cs:2.75,23.9) -- (axis cs: 3,7);
%\node[red,right] at (axis cs: 2,6) {\small 23.9};
%\draw[blue,densely dashed,line width=0.2pt] (axis cs:2.25,165.1) -- (axis cs: 1.5,300);
%\node[blue,right] at (axis cs: 1, 340) {\small 165.1};

%13
%21.8
%164.5

%\addplot+ [onlymarks,draw=black,mark=*,mark size=0.5pt,mark options={fill=black,},
%]table[x=x,y=y] \outlierdatatable;
%coordinates { 
%	(1,0)
%	(1, 100)
%	(2, 100)
%	(2, 100)
%};


\end{axis}
\end{tikzpicture}

\end{document}

